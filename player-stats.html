<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆç¸¾ã‚’è¦‹ã‚‹ | Minecraft Hive Stats</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background-color: #f8fafc; }
        .hero-small { background:#222; padding:3rem 1rem; color:white; }
        .stat-card { transition:0.2s; }
        .stat-card:hover { transform:translateY(-3px); }
        #loading { display:none; }
    </style>
</head>
<body>

<!-- ãƒŠãƒ“ãƒãƒ¼ -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand fw-bold" href="index.html">Minecraft PVP & HIVE</a>
    </div>
</nav>

<header class="hero-small text-center">
    <h1 class="fw-bold">Hive æˆç¸¾ã‚’è¦‹ã‚ˆã†ï¼</h1>
    <p class="lead">ã‚²ãƒ¼ãƒãƒ¼ã‚¿ã‚°ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åï¼‰ã‚’å…¥åŠ›ã—ã‚ˆã†</p>
</header>

<!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
<section class="py-5">
    <div class="container text-center" style="max-width:600px;">
        <input type="text" id="gamertag" class="form-control mb-3" placeholder="ä¾‹: Kito_YT">
        <button onclick="searchPlayer()" class="btn btn-warning w-100">â–¶ æˆç¸¾ã‚’è¡¨ç¤º</button>

        <div id="loading" class="mt-3 text-secondary">èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>
</section>

<!-- çµæœè¡¨ç¤º -->
<section class="pb-5">
    <div class="container">
        <div id="result"></div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
async function searchPlayer() {
    const name = document.getElementById("gamertag").value.trim();
    if (!name) return alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");

    document.getElementById("loading").style.display = "block";
    document.getElementById("result").innerHTML = "";

    try {
        // ç„¡æ–™ãƒ—ãƒ­ã‚­ã‚·ï¼ˆå…¬å…±APIä¸­ç¶™ï¼‰
        const url = `https://api.hivemc.com/v1/player/${name}`;
        const proxy = "https://api.allorigins.win/raw?url=" + encodeURIComponent(url);

        const res = await fetch(proxy);
        if (!res.ok) throw new Error("å–å¾—å¤±æ•—");

        const data = await res.json();

        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå­˜åœ¨ã—ãªã„
        if (!data.status) {
            document.getElementById("result").innerHTML =
                `<div class="alert alert-danger">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>`;
            document.getElementById("loading").style.display = "none";
            return;
        }

        showStats(data);
    } catch (err) {
        document.getElementById("result").innerHTML =
            `<div class="alert alert-danger">å–å¾—ã‚¨ãƒ©ãƒ¼ã€‚æ™‚é–“ã‚’ç½®ã„ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚</div>`;
        console.log(err);
    }

    document.getElementById("loading").style.display = "none";
}

function showStats(data) {
    const container = document.getElementById("result");

    const general = `
        <div class="card shadow-sm stat-card mb-4">
            <div class="card-body">
                <h3 class="card-title">${data.UUID}</h3>
                <p class="mb-0"><strong>ç·ãƒ—ãƒ¬ã‚¤æ™‚é–“:</strong> ${data.total_time_played || 0} åˆ†</p>
                <p class="mb-0"><strong>æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³:</strong> ${data.last_login || "ä¸æ˜"}</p>
                <p class="mb-0"><strong>ãƒ¬ãƒ™ãƒ«:</strong> ${data.first_login_level || "ä¸æ˜"}</p>
            </div>
        </div>
    `;

    container.innerHTML += `<h3 class="mb-3">ğŸ‘‘ ç·åˆæˆç¸¾</h3>${general}`;

    // ã‚²ãƒ¼ãƒ ã”ã¨ã®è¡¨ç¤º
    if (data.games) {
        container.innerHTML += `<h3 class="mt-5 mb-3">ğŸ® ã‚²ãƒ¼ãƒ åˆ¥æˆç¸¾</h3>`;
        Object.keys(data.games).forEach(g => {
            const game = data.games[g];
            container.innerHTML += `
                <div class="card shadow-sm stat-card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">${g}</h5>
                        <p class="mb-0"><strong>å‹åˆ©æ•°:</strong> ${game.wins || 0}</p>
                        <p class="mb-0"><strong>ã‚­ãƒ«:</strong> ${game.kills || 0}</p>
                        <p class="mb-0"><strong>ãƒ‡ã‚¹:</strong> ${game.deaths || 0}</p>
                        <p class="mb-0"><strong>K/D:</strong> ${(game.kills / (game.deaths || 1)).toFixed(2)}</p>
                    </div>
                </div>
            `;
        });
    }
}
</script>

</body>
</html>
